geom_histogram(aes(x=X5))
count %>%
geom_histogram(aes(x=x5))
count %>%
?geom_histogram
geom_histogram()
count %>%
ggplot(aes(x=X5)) + geom_histogram()
setwd("C:/Users/mahdi/OneDrive - KÃ¸benhavns Universitet/High Throughput Analysis/high_throughput")
test_data <- read.table('test/GSE52778_All_Sample_FPKM_Matrix.txt/GSE52778_All_Sample_FPKM_Matrix.txt')
head(test_data)
test_data <- read.table('test/GSE52778_All_Sample_FPKM_Matrix.txt/GSE52778_All_Sample_FPKM_Matrix.txt', header = T)
head(test_data)
str(test_data)
dim(test_data)
sessionInfo()$R.version$version.string
if (!requireNamespace("BiocManager", quietly = TRUE)) {
install.packages("BiocManager")
}
if (!requireNamespace("devtools", quietly = TRUE)){
install.packages("devtools")
}
BiocManager::install()
packagesNeeded <- c(
'DESeq2',
'GGally',
'pheatmap',
'BSgenome.Hsapiens.UCSC.hg19',
'BSgenome.Mmusculus.UCSC.mm10'
)
BiocManager::install(packagesNeeded)
library('DESeq2')
library(IsoformSwitchAnalyzeR)
library(tidyverse)
oil <- read_tsv("Class/data_for_pca/data_for_pca/oil_measurements.tab")
oil
oil_groups <- read_tsv("Class/data_for_pca/data_for_pca/oil_groups.tab")
oil_groups
oil_measurements <- read_tsv("Class/data_for_pca/data_for_pca/oil_measurements.tab")
oil_measurements
dim(oil_measurements)
top(oil_measurements)
library(tidyverse)
# GGally includes many pre-made graphs
library(GGally)
# Pheatmap for good-looking heatmaps
library(pheatmap)
# Viridis for nice color gradients
library(viridis)
head(oil_measurements)
summary(oil_measurements)
oil_measurements <- read_tsv("Class/data_for_pca/data_for_pca/oil_measurements.tab") %>% as.matrix
dim(oil_measurements)
head(oil_measurements)
summary(oil_measurements)
dim(oil_measurements)
dim(oil_groups)
head(oil_groups)
oil_annotate <- cbind(oil_measurements, oil_groups)
oil_annotate
head(oil_annotate)
pca_oil <- prcomp(oil_measurements)
pca_oil$sdev
pca_oil
pca_oil$sdev
pca_oil_annotated <- cbind(as_tibble(pca_oil$x), oil_groups)
pca_oil_annotated
head(pca_oil_annotated)
dim(oil_groups)
head(oil_groups)
ggplot(as_tibble(pca_oil$x), aes(x=PC1, y=PC2))
head(pca_oil_annotated)
ggplot(as_tibble(pca_oil$x), aes(x=PC1, y=PC2)) + geom_scatter()
ggplot(as_tibble(pca_oil$x), aes(x=PC1, y=PC2)) + geom_point()
ggplot(as_tibble(pca_oil$x), aes(x=PC1, y=PC2, col=region)) + geom_point()
ggplot(pca_oil_annotated, aes(x=PC1, y=PC2, col=macro.area)) + geom_point()
ggplot(pca_oil_annotated, aes(x=PC3, y=PC4, col=macro.area)) + geom_point()
ggplot(pca_oil_annotated, aes(x=PC1, y=PC2, col=macro.area)) + geom_point()
head(pca_oil_annotated)
ggplot(pca_oil_annotated, aes(x=PC1, y=PC2, col=region)) + geom_point()
ggplot(pca_oil_annotated, aes(x=PC1, y=PC2, col=macro.area)) + geom_point()
ggplot(pca_oil_annotated, aes(x=PC1, y=PC2, col=region)) + geom_point()
ggplot(pca_oil_annotated, aes(x=PC1, y=PC2, col=macro.area)) + geom_point()
ggplot(pca_oil_annotated, aes(x=PC3, y=PC4, col=macro.area)) + geom_point()
ggplot(pca_oil_annotated, aes(x=PC1, y=PC2, col=macro.area)) + geom_point()
ggplot(pca_oil_annotated, aes(x=PC1, y=PC2, col=region)) + geom_point()
summary(oil_groups$region)
unique(oil_groups$region)
ggplot(pca_oil_annotated, aes(x=PC1, y=PC2, col=region)) + geom_point()
ggplot(pca_oil_annotated, aes(x=PC1, y=PC2, col=macro.area)) + geom_point()
ggplot(pca_oil_annotated, aes(x=PC1, y=PC2, col=macro.area)) + geom_point()
ggplot(pca_oil_annotated, aes(x=PC1, y=PC2, col=macro.area)) + geom_point()
ggplot(pca_oil_annotated, aes(x=PC1, y=PC2, col=region)) + geom_point()
ggplot(pca_oil_annotated, aes(x=PC3, y=PC4, col=macro.area)) + geom_point()
ggplot(pca_oil_annotated, aes(x=PC3, y=PC4, col=region)) + geom_point()
pca_oil_annotated
pca_oil
pca_oil$sdev
summary(pca_oil)
ggplot(pca_oil_annotated, aes(x=PC1, y=PC2, col=region)) + geom_point()
ggplot(pca_oil_annotated, aes(x=PC1, y=PC2, col=macro.area)) + geom_point()
ggplot(pca_oil_annotated, aes(x=PC3, y=PC4, col=region)) + geom_point()
ggplot(pca_oil_annotated, aes(x=PC1, y=PC2, col=region)) + geom_point()
#Ex 2
pca_oil <- prcomp(oil_measurements, scale. = TRUE)
pca_oil_annotated <- cbind(as_tibble(pca_oil$x), oil_groups)
head(pca_oil_annotated)
summary(pca_oil)
ggplot(pca_oil_annotated, aes(x=PC1, y=PC2, col=region)) + geom_point()
ggplot(pca_oil_annotated, aes(x=PC1, y=PC2, col=marco.area, shape=region)) + geom_point()
pca_oil <- prcomp(oil_measurements, scale. = TRUE)
pca_oil_annotated <- cbind(as_tibble(pca_oil$x), oil_groups)
head(pca_oil_annotated)
summary(pca_oil)
ggplot(pca_oil_annotated, aes(x=PC1, y=PC2, col=marco.area, shape=region)) + geom_point()
ggplot(pca_oil_annotated, aes(x=PC1, y=PC2, col=macro.area, shape=region)) + geom_point()
ggplot(pca_oil_annotated, aes(x=PC1, y=PC2, col=region, shape=macro.area)) + geom_point()
summary(pca_oil)
ggplot(pca_oil_annotated, aes(x=PC3, y=PC4, col=region)) + geom_point()
ggplot(pca_oil_annotated, aes(x=PC1, y=PC2, col=region, shape=macro.area)) + geom_point()
ggplot(pca_oil_annotated, aes(x=PC3, y=PC4, col=region, shape=macro.area)) + geom_point()
ggplot(pca_oil_annotated, aes(x=PC1, y=PC2, col=region, shape=macro.area)) + geom_point()
wang_measurements <- read_tsv("Class/data_for_pca/data_for_pca/wang_measurements.tab")
wang_groups <- read_tsv("Class/data_for_pca/data_for_pca/wang_groups.tab")
wang_measurements
dim(wang_measurements)
pca_wang <- prcomp(wang_measurements, scale. = TRUE)
summary(pca_wang)
wang_groups
pca_wang_annotate <- cbind(pca_wang, wang_groups)
#ggplot(pca_oil_annotated, aes(x=PC1, y=PC2, col=region, shape=macro.area)) + geom_point()
str(wang_groups)
#ggplot(pca_oil_annotated, aes(x=PC1, y=PC2, col=region, shape=macro.area)) + geom_point()
summary(wang_groups)
#ggplot(pca_oil_annotated, aes(x=PC1, y=PC2, col=region, shape=macro.area)) + geom_point()
hist(wang_groups)
#ggplot(pca_oil_annotated, aes(x=PC1, y=PC2, col=region, shape=macro.area)) + geom_point()
pca_wang_annotate
pca_wang_annotate <- cbind(pca_wang, wang_groups)
#ggplot(pca_oil_annotated, aes(x=PC1, y=PC2, col=region, shape=macro.area)) + geom_point()
pca_wang
#ggplot(pca_oil_annotated, aes(x=PC1, y=PC2, col=region, shape=macro.area)) + geom_point()
dim(pca_wang)
pca_wang <- prcomp(wang_measurements, scale. = TRUE)
#ggplot(pca_oil_annotated, aes(x=PC1, y=PC2, col=region, shape=macro.area)) + geom_point()
dim(pca_wang)
#Ex 3
wang_measurements <- read_tsv("Class/data_for_pca/data_for_pca/wang_measurements.tab") %>% as.matrix
wang_groups <- read_tsv("Class/data_for_pca/data_for_pca/wang_groups.tab")
dim(wang_measurements)
dim(wang_groups)
#ggplot(pca_oil_annotated, aes(x=PC1, y=PC2, col=region, shape=macro.area)) + geom_point()
wang_groups
#ggplot(pca_oil_annotated, aes(x=PC1, y=PC2, col=region, shape=macro.area)) + geom_point()
wang_groups.T
#ggplot(pca_oil_annotated, aes(x=PC1, y=PC2, col=region, shape=macro.area)) + geom_point()
t(wang_groups)
#ggplot(pca_oil_annotated, aes(x=PC1, y=PC2, col=region, shape=macro.area)) + geom_point()
cbind(pca_wang, t(wang_groups))
dim(t(wang_groups))
dim(wang_measurements)
dim(wang_groups)
head(wang_measurements)
head(wang_groups)
wang_measurements
t(wang_measurements)
test <- cbind(t(wang_measurements), wang_groups)
test
t(test)
cbind(pca_wang, t(wang_groups))
pca_wang
wang_measurements
head(wang_measurements)
gene_rows <-t(wang_measurements), wang_groups
head(gene_rows)
gene_rows <-cbind(t(wang_measurements), wang_groups)
head(gene_rows)
head(wang_measurements)
gene_rows <-t(cbind(t(wang_measurements), wang_groups))
head(gene_rows)
#Ex 5
crohns_measurements <- read_tsv("Class/data_for_pca/data_for_pca/crohns_measurements.tab") %>% as.matrix
crohns_groups <- read_tsv("Class/data_for_pca/data_for_pca/crohns_groups.tab")
dim(crohns_measurements)
dim(crohns_groups)
dim(crohns_measurements)
dim(crohns_groups)
head(crohns_measurements)
head(crohns_groups)
crohns_measurements <- t(crohns_measurements)
pca_crohns <- prcomp(crohns_measurements, scale. = T, center = T)
pca_crohns
pca_crohns$x
pca_crohns_annotated <- cbind(as_tibble(pca_crohns$x), crohns_groups[2:3])
head(pca_crohns_annotated)
unique(pca_crohns_annotated$condition)
head(crohns_groups)
unique(pca_crohns_annotated$condition)
unique(pca_crohns_annotated$batch)
ggplot(pca_crohns_annotated, aes(x=PC1, y=PC2, col=batch, shape=conidtion)) + geom_point()
ggplot(pca_crohns_annotated, aes(x=PC1, y=PC2, col=batch, shape=condition)) + geom_point()
ggplot(pca_crohns_annotated, aes(x=PC1, y=PC2, col=batch)) + geom_point() + facet_wrap(condition)
ggplot(pca_crohns_annotated, aes(x=PC1, y=PC2, col=batch)) + geom_point() + facet_wrap(facets = conditions)
ggplot(pca_crohns_annotated, aes(x=PC1, y=PC2, col=batch)) + geom_point() + facet_wrap(~condition)
ggplot(pca_crohns_annotated, aes(x=PC1, y=PC2, col=batch, shape=condition, size=10)) + geom_point()
ggplot(pca_crohns_annotated, aes(x=PC1, y=PC2, col=batch, shape=condition, size=5)) + geom_point()
ggplot(pca_crohns_annotated, aes(x=PC1, y=PC2, col=batch, shape=condition, size=5)) + geom_point()
ggplot(pca_crohns_annotated, aes(x=PC1, y=PC2, col=batch, shape=condition, size=3)) + geom_point()
ggplot(pca_crohns_annotated, aes(x=PC1, y=PC2, col=batch, shape=condition, size=2)) + geom_point()
ggplot(pca_crohns_annotated, aes(x=PC1, y=PC2, col=batch, shape=condition)) + geom_point(size=2)
ggplot(pca_crohns_annotated, aes(x=PC1, y=PC2, col=batch, shape=condition)) + geom_point(size=10)
ggplot(pca_crohns_annotated, aes(x=PC1, y=PC2, col=batch, shape=condition)) + geom_point(size=5)
ggplot(pca_crohns_annotated, aes(x=PC1, y=PC2, col=batch, shape=condition)) + geom_point(size=3)
ggplot(pca_crohns_annotated, aes(x=PC3, y=PC4, col=batch, shape=condition)) + geom_point(size=3)
ggplot(pca_crohns_annotated, aes(x=PC1, y=PC3, col=batch, shape=condition)) + geom_point(size=3)
ggplot(pca_crohns_annotated, aes(x=PC1, y=PC2, col=batch, shape=condition)) + geom_point(size=3)
ggplot(pca_crohns_annotated, aes(x=PC2, y=PC3, col=batch, shape=condition)) + geom_point(size=3)
ggplot(pca_crohns_annotated, aes(x=PC2, y=PC3, shape=condition)) + geom_point(size=3)
ggplot(pca_crohns_annotated, aes(x=PC2, y=PC3, col=batch, shape=condition)) + geom_point(size=3)
ggplot(pca_crohns_annotated, aes(x=PC1, y=PC2, col=batch)) + geom_point() + facet_wrap(~condition)
ggplot(pca_crohns_annotated, aes(x=PC1, y=PC2, col=batch, shape=condition)) + geom_point(size=3)
ggplot(pca_crohns_annotated, aes(x=PC1, y=PC2 shape=condition)) + geom_point(size=3)
ggplot(pca_crohns_annotated, aes(x=PC1, y=PC2, shape=condition)) + geom_point(size=3)
head(pca_crohns_annotated)
pca_crohns_annotated %>%
filter(condition = "CDa") %>%
head
pca_crohns_annotated %>%
filter(condition == "CDa") %>%
head
pca_crohns_annotated %>%
filter(condition == "CDa") %>%
select(1:49)
pca_crohns_annotated %>%
filter(condition == "CDa") %>%
select(1:49) %>%
var
pca_crohns_annotated %>%
filter(condition == "CDa") %>%
select(1:49) %>%
head
pca_crohns_annotated %>%
filter(condition == "CDa") %>%
select(1:49) %>%
apply(. var)
pca_crohns_annotated %>%
filter(condition == "CDa") %>%
select(1:49) %>%
apply(, 1, car)
pca_crohns_annotated %>%
filter(condition == "CDa") %>%
select(1:49) %>%
apply(., 1, var)
pca_crohns_annotated %>%
filter(condition == "CDa") %>%
select(1:49) %>%
apply(., 2, var)
pca_crohns_annotated %>%
filter(condition == "con") %>%
select(1:49) %>%
apply(., 2, var)
library(tidyverse)
library(DESeq2)
setwd("C:/Users/mahdi/OneDrive - KÃ¸benhavns Universitet/High Throughput Analysis/high_throughput")
# Information about samples
design <- read_tsv("Class/DE_datasets/IBD_study_design.tab")
# Count matrix (This is not a tibble, so we read it
#in as a data.frame and convert to matrix)
EM <- read.table("Class/DE_datasets/IBD_count_matrix.tab") %>% as.matrix
head(design)
head(EM)
?DESeqDataSetFromMatrix
?contrasts
design
dds <- DESeqDataSetFromMatrix(countData = EM, # Count matrix
colData = design, # - indicate what the design matrix is
design = ~ Class # - and then what column that 'splits' the data
# in this case the wto values in 'Minute': min0 and min30
)
dds <- DESeq(dds)
res <- results(dds)
res
dds
res
res_cda <- results(dds, contrast = c("Class", "con", "CDa"))
res_cda <- results(dds, contrast = c("Class", "con", "UCa"))
res_both <- results(dds, contrast = c("Class", "CDa", "UCa"))
res_cda
res_cda <- results(dds, contrast = c("Class", "con", "CDa")) %>% as.data.frame %>% rownames_to_column("Gene") %>% as_tibble
res_cda
res_cda <- results(dds, contrast = c("Class", "con", "CDa")) %>% as.data.frame %>% rownames_to_column("Gene") %>% as_tibble
res_cda <- results(dds, contrast = c("Class", "con", "UCa")) %>% as.data.frame %>% rownames_to_column("Gene") %>% as_tibble
res_both <- results(dds, contrast = c("Class", "CDa", "UCa")) %>% as.data.frame %>% rownames_to_column("Gene") %>% as_tibble
res_cda
plotDispEsts(dds)
dds
ggplot(res_cda, aes(x=baseMean, y=log2FoldChange)) +
geom_point(alpha=0.5) + geom_smooth() +
scale_x_log10() +
geom_hline(yintercept = 0, alpha = 0.75,
color="red")+
theme_bw()
res_cda <- results(dds, contrast = c("Class", "con", "CDa"), alpha = 0.05) %>% as.data.frame %>% rownames_to_column("Gene") %>% as_tibble
res_cda <- results(dds, contrast = c("Class", "con", "UCa"), alpha = 0.05) %>% as.data.frame %>% rownames_to_column("Gene") %>% as_tibble
res_both <- results(dds, contrast = c("Class", "CDa", "UCa"), alpha = 0.05) %>% as.data.frame %>% rownames_to_column("Gene") %>% as_tibble
#Dispersion plot
plotDispEsts(dds)
#MA plot
ggplot(res_cda, aes(x=baseMean, y=log2FoldChange)) +
geom_point(alpha=0.5) + geom_smooth() +
scale_x_log10() +
geom_hline(yintercept = 0, alpha = 0.75,
color="red")+
theme_bw()
#Dispersion plot
plotDispEsts(dds)
ggplot(res_cda, aes(x=baseMean, y=log2FoldChange)) +
geom_point(alpha=0.5) + geom_smooth() +
scale_x_log10() +
geom_hline(yintercept = 0, alpha = 0.75,
color="red")+
theme_bw()
res_cda <- results(dds, contrast = c("Class", "con", "CDa"), alpha = 0.05) %>% as.data.frame %>% rownames_to_column("Gene") %>% as_tibble
res_uca <- results(dds, contrast = c("Class", "con", "UCa"), alpha = 0.05) %>% as.data.frame %>% rownames_to_column("Gene") %>% as_tibble
res_both <- results(dds, contrast = c("Class", "CDa", "UCa"), alpha = 0.05) %>% as.data.frame %>% rownames_to_column("Gene") %>% as_tibble
results <- list(res_cda, res_uca, res_both)
for (i in results){
ggplot(res_cda, aes(x=baseMean, y=log2FoldChange)) +
geom_point(alpha=0.5) + geom_smooth() +
scale_x_log10() +
geom_hline(yintercept = 0, alpha = 0.75,
color="red")+
theme_bw()
}
#MA plot
results <- list(res_cda, res_uca, res_both)
for (i in results){
ggplot(i, aes(x=baseMean, y=log2FoldChange)) +
geom_point(alpha=0.5) + geom_smooth() +
scale_x_log10() +
geom_hline(yintercept = 0, alpha = 0.75,
color="red")+
theme_bw()
}
ggplot(res_both, aes(x=baseMean, y=log2FoldChange)) +
geom_point(alpha=0.5) + geom_smooth() +
scale_x_log10() +
geom_hline(yintercept = 0, alpha = 0.75,
color="red")+
theme_bw()
ggplot(res_uca, aes(x=baseMean, y=log2FoldChange)) +
geom_point(alpha=0.5) + geom_smooth() +
scale_x_log10() +
geom_hline(yintercept = 0, alpha = 0.75,
color="red")+
theme_bw()
ggplot(res_cda, aes(x=baseMean, y=log2FoldChange)) +
geom_point(alpha=0.5) + geom_smooth() +
scale_x_log10() +
geom_hline(yintercept = 0, alpha = 0.75,
color="red")+
theme_bw()
ggplot(as.data.frame(res_cda), aes(x=pvalue)) +
geom_histogram(binwidth = 0.05,
fill="hotpink", color="black")+theme_bw()
ggplot(as.data.frame(res_uca), aes(x=pvalue)) +
geom_histogram(binwidth = 0.05,
fill="hotpink", color="black")+theme_bw()
ggplot(as.data.frame(res_both), aes(x=pvalue)) +
geom_histogram(binwidth = 0.05,
fill="hotpink", color="black")+theme_bw()
#P value dist
ggplot(as.data.frame(res_cda), aes(x=pvalue)) +
geom_histogram(binwidth = 0.05,
fill="hotpink", color="black")+theme_bw()
ggplot(as.data.frame(res_uca), aes(x=pvalue)) +
geom_histogram(binwidth = 0.05,
fill="hotpink", color="black")+theme_bw()
ggplot(as.data.frame(res_both), aes(x=pvalue)) +
geom_histogram(binwidth = 0.05,
fill="hotpink", color="black")+theme_bw()
ggplot(as.data.frame(res_uca), aes(x=pvalue)) +
geom_histogram(binwidth = 0.05,
fill="hotpink", color="black")+theme_bw()
#P value dist
ggplot(as.data.frame(res_cda), aes(x=pvalue)) +
geom_histogram(binwidth = 0.05,
fill="hotpink", color="black")+theme_bw()
ggplot(as.data.frame(res_uca), aes(x=pvalue)) +
geom_histogram(binwidth = 0.05,
fill="hotpink", color="black")+theme_bw()
ggplot(as.data.frame(res_cda), aes(x=pvalue)) +
geom_histogram(binwidth = 0.05,
fill="hotpink", color="black")+theme_bw()
ggplot(as.data.frame(res_cda), aes(x=pvalue)) +
geom_histogram(binwidth = 0.05,
fill="hotpink", color="black")+theme_bw()
ggplot(as.data.frame(res_uca), aes(x=pvalue)) +
geom_histogram(binwidth = 0.05,
fill="hotpink", color="black")+theme_bw()
ggplot(res_cda, aes(x=dense_rank(baseMean),
y=-log10(pvalue), color=padj < 0.05)) +
geom_point(alpha=0.5)+theme_bw()
ggplot(res_uca, aes(x=dense_rank(baseMean),
y=-log10(pvalue), color=padj < 0.05)) +
geom_point(alpha=0.5)+theme_bw()
ggplot(res_both, aes(x=dense_rank(baseMean),
y=-log10(pvalue), color=padj < 0.05)) +
geom_point(alpha=0.5)+theme_bw()
results(dds)
ggplot(res_cda, aes(x=log2FoldChange,
y=-log10(pvalue), color=padj < 0.05)) +
geom_point(alpha=0.5) +
geom_vline(xintercept = 0, alpha = 0.75,
linetype="dashed")+theme_bw()
ggplot(res_uca, aes(x=log2FoldChange,
y=-log10(pvalue), color=padj < 0.05)) +
geom_point(alpha=0.5) +
geom_vline(xintercept = 0, alpha = 0.75,
linetype="dashed")+theme_bw()
ggplot(res_both, aes(x=log2FoldChange,
y=-log10(pvalue), color=padj < 0.05)) +
geom_point(alpha=0.5) +
geom_vline(xintercept = 0, alpha = 0.75,
linetype="dashed")+theme_bw()
ggplot(res_cda, aes(x=baseMean, y=log2FoldChange)) +
geom_point(alpha=0.5) + geom_smooth() +
scale_x_log10() +
geom_hline(yintercept = 0, alpha = 0.75,
color="red")+
theme_bw()
ggplot(res_cda, aes(x=dense_rank(baseMean),
y=-log10(pvalue), color=padj < 0.05)) +
geom_point(alpha=0.5)+theme_bw()
#check output
dds
#check output
dds$Sample
#check output
dds$Class
#check output
dds$sizeFactor
#check output
res_cda
ggplot(res_cda, aes(x=dense_rank(baseMean),
y=-log10(pvalue), color=padj < 0.05)) +
geom_point(alpha=0.5)+theme_bw()
ggplot(res_both, aes(x=dense_rank(baseMean),
y=-log10(pvalue), color=padj < 0.05)) +
geom_point(alpha=0.5)+theme_bw()
ggplot(res_uca, aes(x=dense_rank(baseMean),
y=-log10(pvalue), color=padj < 0.05)) +
geom_point(alpha=0.5)+theme_bw()
ggplot(res_cda, aes(x=log2FoldChange,
y=-log10(pvalue), color=padj < 0.05)) +
geom_point(alpha=0.5) +
geom_vline(xintercept = 0, alpha = 0.75,
linetype="dashed")+theme_bw()
#Compare manually
res_cda
#Compare manually
res_cda %>%
arrange(desc(padj))
#Compare manually
res_cda %>%
arrange(padj)
res_uca %>%
arrange(padj)
res_both %>%
arrange(padj)
plotDispEsts(dds)
library(tidyverse)
# GGally includes many pre-made graphs
library(GGally)
# Pheatmap for good-looking heatmaps
library(pheatmap)
# Viridis for nice color gradients
library(viridis)
crohns_measurements <- read_tsv("Class/data_for_pca/data_for_pca/crohns_measurements.tab") %>% as.matrix
crohns_groups <- read_tsv("Class/data_for_pca/data_for_pca/crohns_groups.tab")
dim(crohns_measurements)
dim(crohns_groups)
head(crohns_measurements)
head(crohns_groups)
crohns_measurements <- t(crohns_measurements)
pca_crohns <- prcomp(crohns_measurements, scale. = T, center = T)
pca_crohns_annotated <- cbind(as_tibble(pca_crohns$x), crohns_groups[2:3])
head(pca_crohns_annotated)
unique(pca_crohns_annotated$batch)
ggplot(pca_crohns_annotated, aes(x=PC1, y=PC2, col=batch)) + geom_point() + facet_wrap(~condition)
ggplot(pca_crohns_annotated, aes(x=PC1, y=PC2, shape=condition)) + geom_point(size=3)
pca_crohns_annotated %>%
filter(condition == "con") %>%
select(1:49) %>%
apply(., 2, var)
crohns_measurements
crohns_groups
dim(crohns_groups)
head(crohns_groups)
head(crohns_measurements)
head(crohns_groups)
dim(crohns_groups)
crohns_measurements <- t(crohns_measurements)
crohns_measurements
crohns_groups[2:3]
read_tsv("Class/data_for_pca/data_for_pca/crohns_measurements.tab")
head(pca_crohns_annotated)
cbind(as_tibble(pca_crohns$x), crohns_groups[2:3]) %>% head
head(crohns_measurements)
head(crohns_groups)
t(crohns_measurements)
mtcars
